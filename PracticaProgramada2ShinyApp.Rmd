---
title: "Práctica programada 2"
author: "Ana Gabriela Álvarez Ruiz"
date: "2023-11-26"
editor_options: 
  markdown: 
    wrap: 72
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(shinydashboard)
library(dplyr)
library(readr)
library(ggplot2)
library(gapminder)
```

```{r}
ui <- dashboardPage(
  dashboardHeader(title = "Tablero de Colegios"),
  
  dashboardSidebar(disable = TRUE), # Deshabilito el sidebar
  
  dashboardBody(
    fluidRow(
      column(2, selectInput("curso", "Curso Lectivo:", choices = NULL, selected = NULL)),
      column(2, selectInput("region", "Región:", choices = NULL, selected = NULL)),
      column(2, selectInput("provincia", "Provincia:", choices = NULL, selected = NULL)),
      column(2, selectInput("canton", "Cantón:", choices = NULL, selected = NULL)),
      column(2, selectInput("distrito", "Distrito:", choices = NULL, selected = NULL)),
      column(2, actionButton("filtrar", "Filtrar Datos"))
    ),
    tableOutput("tabla_colegios")
  )
)

server <- function(input, output, session) {
  
  datos_libertad <- readr::read_csv("datos/datos_libertad.csv")
  
  # Actualizar las opciones de los selectInputs con valores únicos del dataset
  observe({ # El observe es para actualizar los valores inmediatamente
    updateSelectInput(session, "curso", choices = unique(datos_colegios$`CURSO LECTIVO`)) # Actualiza el input curso
    updateSelectInput(session, "region", choices = unique(datos_colegios$REGION)) # Actualiza el input region
    updateSelectInput(session, "provincia", choices = unique(datos_colegios$PROVINCIA)) # Actualiza el input provincia
    updateSelectInput(session, "canton", choices = unique(datos_colegios$CANTON)) # Actualiza el input canton
    updateSelectInput(session, "distrito", choices = unique(datos_colegios$DISTRITO)) # Actualiza el input distrito
  })
  
  observeEvent(input$filtrar, {
    output$tabla_colegios <- renderTable({
      
      datos_filtrados <- datos_colegios |>
        filter(`CURSO LECTIVO` == input$curso) |>
        filter(REGION == input$region) |>
        filter(PROVINCIA == input$provincia) |>
        filter(CANTON == input$canton) |>
        filter(DISTRITO == input$distrito)
      
      datos_filtrados
    })
  })
  
}

shinyApp(ui, server)
```

